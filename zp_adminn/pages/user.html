<style>
	#btn_add{
		float: right;
		margin-top: 10px;
	/*	margin-left: 800px;*/

	}
	.modal-backdrop.show{
		z-index: -1;
	}
	#useradd_modal{
		font-weight: bold;
		margin-top: 10px;
	}
	.input-group{
		width: 280px;
		margin-left: 20px;
	}
</style>
<div class="main">
	<div class="layui-tab">
 	 	<ul class="layui-tab-title">
    		<li class="layui-this">用户列表</li>
  		</ul>
  		<button class="btn btn-light" id="btn_add">添加用户</button>
  	<div class="layui-tab-content">
    	<div class="layui-tab-item layui-show">
    		<div class="row">
    			<select name="job" id="user_degree" class="form-control mb-3 col-3">
    				<option value="">学历</option>
    			</select>
    			<!-- 按性别查询 -->
    			<select name="job" id="user_gender" class="form-control mb-3 col-3">
    				<option value="">性别</option>
    			</select>
    			<!-- 按性别查询结束 -->
    			<!-- 按标题查询 -->
		   		<div class="input-group mb-3">
			  		<input type="text" placeholder="请输入关键字" class="form-control" >
			  		<div class="input-group-append">
			   			 <span class="input-group-text" id="basic-addon2">查询</span>
			  		</div>
				</div>
    			<!-- 按标题查询结束 -->
   			</div>
    	<!-- 表格 -->
    	<table class="table " id="user_table">
    		<thead class="table-dark">
    			<tr>
    				<td>#</td>
    				<td>用户名</td>
    				<td>姓名</td>
    				<td>手机号</td>
    				<td>性别</td>
    				<td>出生年月</td>
    				<td>最高学历</td>
    				<td>操作</td>
    			</tr>
    		</thead>
    		<tbody>
    			
    		</tbody>
    	</table>
    	<!-- 表格结束 -->
    	<!-- 添加的模态框 -->
    	<div class="modal"  id="useradd_modal">
			 <div class="modal-dialog modal-lg" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <h5 class="modal-title">添加用户</h5>
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			          	<span aria-hidden="true">&times;</span>
			        </button>
			      </div>
			      <div class="modal-body">
			      <!-- 添加用户模态框 -->
			      	<form  id="useradd_form">
					<div class="row mt-2">
						<!-- 用户名 -->
					<div class=" form-group col-6 row">
			        	<label for="user_username" class="col-4 text-right">用户名</label>
			        	<input type="text" id="user_username" name="username" class="form-control  col-8">
			        </div>
					<!-- 用户名结束 -->
					<!-- 姓名 -->
					<div class=" form-group col-6 row">
			        	<label for="user_realname" class="col-4 text-right">姓名</label>
			        	<input type="text" id="user_realname" name="realname" class="form-control col-8">
			        </div>
					<!-- 姓名 -->
					</div>
					<div class="row">
						<!-- 密码 -->
					<div class=" form-group  col-6 row">
			        	<label for="user_birth" class="col-4 text-right">出生日期</label>
			        	<input type="text" id="user_birth" name="birth" class="form-control col-8">
			        </div>
					<!-- 密码结束 -->
					<!-- 学历 -->
					<div class=" form-group  col-6 row">
			        	<label for="user_education" class="col-4 text-right">学历</label>
			        	<input type="text" id="user_education" name="education" class="form-control col-8">
			        </div>
					<!-- 学历结束 -->
					</div>
					<div class="row">
						<!-- 性别 -->
					<div class="form-group col-6 row">
						<label class="col-4 text-right">性别</label>
						<div class="col-8">
							<div class="form-check form-check-inline">
								<input type="radio" class="form-check-input" value="男" id="input_male" name="gender">
								<label  class="form-check-label"  for="input_male" >男</label>
							</div>
							<div class="form-check form-check-inline">
								<input type="radio" id="input_female" name="gender" value="女" class="form-check-input">
								<label for="input_female">女</label>
							</div>
							</div>
					</div>
					<!-- 性别结束 -->
					<!-- 联系方式 -->
					<div class=" form-group  col-6 row">
			        	<label for="user_telephone" class="col-4 text-right">联系方式</label>
			        	<input type="text" id="user_telephone" name="telephone" class="form-control col-8">
			        </div>
					<!-- 联系方式结束 -->
					
						<!-- 工作时间-->
					<div class=" form-group col-6 row">
			        	<label for="user_workTime" class="col-4 text-right">工作时间</label>
			        	<input type="text" id="user_workTime" name="workTime" class="form-control  col-8">
			        </div>
					<!-- 工作时间结束 -->
					<!-- 求职状态 -->
					<div class=" form-group col-6 row">
			        	<label for="user_currentStatus" class="col-4 text-right ">求职状态</label>
			        	<input type="text" id="user_currentStatus" name="currentStatus" class="form-control col-8">
			        </div>
					<!-- 姓名 -->
					
					<div class=" form-group col-6 row">
			        	<label for="user_resume" class="col-4 text-right">简历</label>
			        	<input type="text" id="user_resume" name="resume" class="form-control col-8">
			        </div>
					<!-- 姓名 -->
					</div>
			       </form>
			      </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			        <button type="button" class="btn btn-primary" onclick="submit()">Save changes</button>
			      </div>
			    </div>
			  </div>
		</div>
    	<!-- 添加的模态框结束 -->
    	<!-- 修改模态框 -->
    	<div class="modal"  id="useremit_modal">
			 <div class="modal-dialog modal-lg" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <h5 class="modal-title">添加用户</h5>
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			          <span aria-hidden="true">&times;</span>
			        </button>
			      </div>
			      <div class="modal-body">
			       <form  id="useremit_form">
			       <!-- id -->
			       	 <div class=" form-group">
			        	<label for="user_id"></label>
			        	<input type="hidden" id="user_id" name="id" class="form-control">
			        </div>
					<!-- id结束 -->
					<div class="row mt-2">
						<!-- 用户名 -->
					<div class=" form-group col-6 row">
			        	<label for="user_username" class="col-4 text-right">用户名</label>
			        	<input type="text" id="user_username" name="username" class="form-control  col-8">
			        </div>
					<!-- 用户名结束 -->
					<!-- 姓名 -->
					<div class=" form-group col-6 row">
			        	<label for="user_realname" class="col-4 text-right">姓名</label>
			        	<input type="text" id="user_realname" name="realname" class="form-control col-8">
			        </div>
					<!-- 姓名 -->
					</div>
					<div class="row">
						<!-- 密码 -->
					<div class=" form-group  col-6 row">
			        	<label for="user_password" class="col-4 text-right">密&nbsp&nbsp码</label>
			        	<input type="text" id="user_password" name="passowrd" class="form-control col-8">
			        </div>
					<!-- 密码结束 -->
					<!-- 学历 -->
					<div class=" form-group  col-6 row">
			        	<label for="user_education" class="col-4 text-right">学历</label>
			        	<input type="text" id="user_education" name="education" class="form-control col-8">
			        </div>
					<!-- 学历结束 -->
					</div>
					<div class="row">
						
					<!-- 联系方式 -->
					<div class=" form-group  col-6 row">
			        	<label for="user_telephone" class="col-4 text-right">联系方式</label>
			        	<input type="text" id="user_telephone" name="telephone" class="form-control col-8">
			        </div>
					<!-- 联系方式结束 -->
					
					</div>
			       </form>
			      </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			        <button type="button" class="btn btn-primary" onclick="emit()">Save changes</button>
			      </div>
			    </div>
			  </div>
		</div>
    	<!-- 修改模态框结束 -->
 		<!-- 提示框开始 -->
    	<div class="toast"  style="position: absolute;top: 1em;right: 1em" >
	  	<div class="toast-header">
	     	<i class="fa fa-bell text-success mr-5"></i>
	    	<strong class="mr-auto">success</strong>
	   		 <small class="text-muted"></small>
	   		 <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" >
	     		 <span aria-hidden="true">&times;</span>
	   		 </button>
  		</div>
		<div class="toast-body">
		</div>
		</div>
    	<!-- 提示框结束 -->
    </div>
  </div>
</div>
</div>
<script>
	var baseURL="http://203.195.246.58:7777";
	// 加载页面函数
	function reloadData(){
		$("#user_table tbody").empty();
		var url=baseURL+"/Jobhunter/findAll";
		$.get(url,function(res){
			if(res.status===200){
				res.data.forEach(function(item){
					 // console.log(item.id,item.username)
					$(`<tr>
				<td><input type="checkbox" value="`+item.id+`"></td>
				<td>`+item.username+`</td>
				<td>`+item.realname+`</td>
				<td>`+item.telephone+`</td>
				<td>`+item.gender+`</td>
				<td>`+item.birth+`</td>
				<td>`+item.education+`</td>
				<td><a href="#" id="btn_del">
						<span class="fa fa-trash text-danger mr-3 "></span></a>
					<a href="#" id="btn_emit">
						<span class="fa fa-edit text-primary "></td>
			</tr>`).appendTo("#user_table tbody")
				})
			}
		})
	}
	// 修改函数
	function emit(){
		var id=$("input[name=id]").val();
		console.log(id)
		var username=$("#useremit_form input[name=username]").val();
		var realname=$("#useremit_form input[name=realname]").val();
		var telephone=$("#useremit_form input[name=telephone]").val();
		var gender= $("input[type=radio]:checked").val();
		// console.log(gender)
		var birth=$("#useremit_form input[name=birth]").val();
		var education=$("#useremit_form input[name=education]").val();
		var url=baseURL+"/Jobhunter/saveOrUpdate"
		// console.log(id)
		var data={
			id:id,
			username:username,
			realname:realname,
			telephone:telephone,
			gender:gender,
			birth:birth,
			education:education
		}
		console.log("data",data);
		$.post(url,data,function(result){
			if (result.status===200) {
				reloadData()
				closeemitmodal()
				
				toast("修改成功")
			}
		})
	}
	// 添加函数
	function submit(){
		var username=$("input[name=username]").val();
		var realname=$("#useradd_form input[name=realname]").val();
		var telephone=$("#useradd_form input[name=telephone]").val();
		var gender= $("input[type=radio]:checked").val();
		// console.log(gender)
		var birth=$("#useradd_form input[name=birth]").val();
		var education=$("#useradd_form input[name=education]").val();
		var workTime=$("#useradd_form input[name=workTime]").val();
		var currentStatus=$("#useradd_form input[name=currentStatus]").val();
		var resume=$("#useradd_form input[name=resume]").val();
		var url=baseURL+"/Jobhunter/saveOrUpdate"
		var data={
			username:username,
			realname:realname,
			telephone:telephone,
			gender:gender,
			birth:birth,
			education:education,
			workTime:workTime,
			currentStatus:currentStatus,
			resume:resume
		}
		console.log("data",data);
		$.post(url,data,function(result){
			if (result.status===200) {
				reloadData()
				closemodal()
				toast("添加成功")
			}
		})
	}	
	// 添加函数结束
	// 关闭模态框函数
	function closemodal(){
	$("#useradd_modal").modal("hide")
	}
	function closeemitmodal(){
	$("#useremit_modal").modal("hide")
	}
	// 关闭模态框函数结束
	// 弹出提示框函数
	function toast(msg){
	$(".toast .toast-body").text(msg);
	$(".toast").toast("show")
	}
	// 弹出提示框函数结束
$(function () {
	// 给添加用户绑定事件
	$("#btn_add").click(function(){
		$("#useradd_modal").modal("show")
		var id=$("#useradd_form input[name=id]").val("");
		var username=$("#useradd_form input[name=username]").val("");
		var realname=$("#useradd_form input[name=realname]").val("");
		var telephone=$("#useradd_form input[name=telephone]").val("");
		var gender= $("input[type=radio]:checked").val("");
		// console.log(gender)
		var birth=$("#useradd_form input[name=birth]").val("");
		var education=$("#useradd_form input[name=education]").val("");
		var workTime=$("#useradd_form input[name=workTime]").val("");
		var currentStatus=$("#useradd_form input[name=currentStatus]").val("");
		var resume=$("#useradd_form input[name=resume]").val("");
	})
	// 给添加用户绑定事件结束
	reloadData()
	$(".toast").toast({
	delay:2000
		})
	// 通过下拉菜单查询
	function onload(){
		var url=baseURL+"/Jobhunter/findAll"
		$.get(url,function(res){
			res.data.forEach(function(item){
				$(`<option name="location" value="`+item.education+`">`+item.education+`</option>`).appendTo("#user_degree")
				$(`<option name="gender" value="`+item.gender+`">`+item.gender+`</option>`).appendTo("#user_gender")
			})
		})
	}
	onload()
	// 通过学历查询
		var data;
		$("#user_degree").change(function(){
			var val=$(this).val();
			var obj={
				education:val
			}
			var url=baseURL+"/Jobhunter/findByEducation";
			$("#user_table tbody").empty();
			$.get(url,obj,function(res){
				onload();
				res.data.forEach(function(item){
					$(`<tr>
				<td><input type="checkbox" value="`+item.id+`"></td>
				<td>`+item.username+`</td>
				<td>`+item.realname+`</td>
				<td>`+item.telephone+`</td>
				<td>`+item.gender+`</td>
				<td>`+item.birth+`</td>
				<td>`+item.education+`</td>
				<td><a href="#" id="btn_del">
						<span class="fa fa-trash text-danger mr-3 "></span></a>
					<a href="#" id="btn_emit">
						<span class="fa fa-edit text-primary "></td>
			</tr>`).appendTo("#user_table tbody")
				})
			})
		})
	// 通过性别查询
		var data;
		$("#user_gender").change(function(){
			var val=$(this).val();
			var obj={
				gender:val
			}
			var url=baseURL+"/Jobhunter/findByGender";
			$("#user_table tbody").empty();
			$.get(url,obj,function(res){
				onload();
				res.data.forEach(function(item){
					$(`<tr>
				<td><input type="checkbox" value="`+item.id+`"></td>
				<td>`+item.username+`</td>
				<td>`+item.realname+`</td>
				<td>`+item.telephone+`</td>
				<td>`+item.gender+`</td>
				<td>`+item.birth+`</td>
				<td>`+item.education+`</td>
				<td><a href="#" id="btn_del">
						<span class="fa fa-trash text-danger mr-3 "></span></a>
					<a href="#" id="btn_emit">
						<span class="fa fa-edit text-primary "></td>
			</tr>`).appendTo("#user_table tbody")
				})
			})
		})
	// 绑定删除和修改事件
	$("#user_table tbody").on("click","a",function(event){
		switch(this.id){
			// 删除事件
			case "btn_del":
			var id=$(this).parents("tr").children("td").find("input").val();
			var data={
				id:id
			}
			$("#user_table tbody").empty()
			var url=baseURL+"/Jobhunter/deleteById"
			$.post(url,data,function(res){
				toast("删除成功");
				reloadData()
			})
			break;
			// 修改事件
			case "btn_emit":
			$("#useremit_modal").modal("show");
			var id=$(this).parents("tr").children().find("input").val();
			// console.log("id火速",id);
			var username=$(this).parents("tr").children("td")[1].innerText;
			var realname=$(this).parents("tr").children("td")[2].innerText;
			var telephone=$(this).parents("tr").children("td")[3].innerText;
			var birth=$(this).parents("tr").children("td")[5].innerText;
			var education=$(this).parents("tr").children("td")[6].innerText;
			$("#useradd_form input[name=id]").val(id)
			// console.log("idddd",id);
			$("#useremit_form input[name=username]").val(username)
			$("#useremit_form input[name=realname]").val(realname)
			$("#useremit_form input[name=telephone]").val(telephone)
			$("#useremit_form input[name=birth]").val(birth)
			$("#useremit_form input[name=education]").val(education)
			break;
		}
	})
	// 绑定删除和修改事件结束
})
</script>